<!DOCTYPE html><html class="g-html2"><head><meta charset="UTF-8"><title>附近餐厅</title><link rel="stylesheet" href="css/libs/m-reset.css"><link rel="stylesheet" href="scss/global.css"></head><body class="g-body"><div class="g-hd"><a href="index.html" class="icon-back"></a><h2 class="hd-tit">附近餐厅</h2></div><div class="m-mask-modal"></div><div class="g-bd g-bd-scene"><ul class="m-restaurant-list2"></ul><button class="btn-loading-more">加载更多</button></div><div class="g-ft"></div><script src="js/rem.js"></script><script src="js/libs/zepto.min.js"></script><script src="js/plugin/jquery-swiper.min.js"></script><script src="js/plugin/store.min.js"></script><script>function nearbyList(a,t){$.ajax({type:"get",url:"http://api.51yuchu.com/index/nearby/list?cityId="+cityId+"&radii=3000&lng="+lng+"&lat="+lat+"&page="+a+"&size="+t,dataType:"json",beforeSend:Loading,success:function(a){if(a.succeed){a.value.length>=t?$(".btn-loading-more").show():($(".btn-loading-more").html("没有更多数据了！"),$(".btn-loading-more").prop("disabled",!0),$(".btn-loading-more").addClass("dis"));for(var e=0;e<a.value.length;e++)restaurant=a.value[e].restaurant,strNearby+='<li><a href="restaurantdetails.html" class="rt-img"><img src="'+restaurant.previewUrl+'" alt=""><p>'+restaurant.content+'</p></a><div class="rt-info"><h3 class="rt-tit">'+restaurant.name+'</h3><p class="rt-cuisine">'+restaurant.keyword+'</p><p class="rt-region">'+restaurant.cityId+'</p><p class="rt-price"><span>¥</span> <em>'+restaurant.startPrice+"</em> <span>-</span> <span>¥</span> <em>"+restaurant.endPrice+"</em></p></div></li>";$(".m-restaurant-list2").html(strNearby)}}})}function Loading(){$(".m-loading").remove(),$(".m-mask-modal").after("<div class='m-loading'><img src='images/loading.gif' /><div>"),$(".m-mask-modal").show(),$("m-restaurant-list2").hide(),setTimeout(function(){$(".m-loading").hide(),$(".m-mask-modal").hide(),$(".m-restaurant-list2").show()},500)}var user=store.get("user"),cityId=user.cityId,lng=user.lng,lat=user.lat,Npage=1,Nsize=5,restaurant={},strNearby="";nearbyList(Npage,Nsize),$(function(){function a(a,t){var e=parseInt(document.body.scrollTop),r=0,s=5;a=parseInt(a),t/=s;var n=setInterval(function(){r++,document.body.scrollTop=(a-e)/t*r+e,r>=t&&clearInterval(n)},s)}$(".btn-loading-more").click(function(){Npage++;var t=$(".g-hd").height(),e=$(".g-bd").height(),r=$(".m-restaurant-list2 li").height(),s=$(".m-restaurant-list2").height(),n=s-(e-s)-t,i=Npage*Nsize*r-n;nearbyList(Npage,Nsize),a(i,300)})});</script></body></html>