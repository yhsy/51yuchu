function orderAjax(a){function e(a){$("#restaurant_list").show();for(var e=0;e<a.length;e++)arrUrl=[],tabId=10,a.eq(e).click(function(){a.removeClass("current"),$(this).prop("class","current");var e=$(this).parent().parent().prop("id"),r="";curLen=$(".m-filter-sort .current").length;var s="";if(1==curLen){if("order_restaurant"==e)r="&sortField="+$(this).attr("okey"),tabId=0;else if("order_region"==e)r="&countyId="+$(this).html(),tabId=1;else if("order_cuisine"==e)r="&cuisineId="+$(this).html(),tabId=2;else if("order_group"==e){var i=0,l=0;if(2==$(this).children("span").length)var i=$(this).children("span").eq(0).html(),l=$(this).children("span").eq(1).html();else if(1==$(this).children("span").length)if($(this).children("span").eq(0).html()>100)var i=$(this).children("span").eq(0).html(),l=2e3;else var i=0,l=$(this).children("span").eq(0).html();r="&sPrice="+i+"&ePrice="+l,tabId=3}arrUrl.length<curLen?arrUrl.push([tabId,r]):(arrUrl[0][0]=tabId,arrUrl[0][1]=r),s=r}else if(curLen<=4){if("order_restaurant"==e)r="&sortField="+$(this).attr("okey"),tabId=0;else if("order_region"==e)r="&countyId="+$(this).html(),tabId=1;else if("order_cuisine"==e)r="&cuisineId="+$(this).html(),tabId=2;else if("order_group"==e){var i=0,l=0;if(2==$(this).children("span").length)var i=$(this).children("span").eq(0).html(),l=$(this).children("span").eq(1).html();else if(1==$(this).children("span").length)if($(this).children("span").eq(0).html()>100)var i=$(this).children("span").eq(0).html(),l=2e3;else var i=0,l=$(this).children("span").eq(0).html();r="&sPrice="+i+"&ePrice="+l,tabId=3}if(arrUrl.length<curLen)arrUrl.push([tabId,r]);else if(arrUrl.length==curLen)for(var n=0;n<arrUrl.length;n++)tabId==arrUrl[n][0]&&(arrUrl[n][1]=r);for(var u=0;u<arrUrl.length;u++)s+=arrUrl[u][1]}$(".tab-nav li a span").eq(tabId).html($(this).html());var c="";$.ajax({type:"get",url:"http://api.51yuchu.com/search/restaurant/do?&cityId="+cityId+"&lat="+lat+"&lng="+lng+s,dataType:"json",beforeSend:t,success:function(a){for(var e=0;e<a.value.length;e++)c=c+'<li class="m-restaurant"><a href="restaurantdetails.html#'+a.value.list[e].restaurant.id+'" class="m-restaurant-img"><img src="'+a.value[e].restaurant.previewUrl+'"alt=""></a><a href="restaurantdetails.html#'+a.value.list[e].restaurant.id+'" class="m-restaurant-text"><h3 class="m-restaurant-tit">'+a.value[e].restaurant.name+'</h3><p class="m-restaurant-region">'+a.value[e].country.name+'</p><p class="m-restaurant-price">'+a.value[e].restaurant.priceStr+'</p></a><div class="m-restaurant-evaluate"><img src="images/bg-pie.png"alt=""><div class="m-evaluate-con"><h4>好评率</h4><p class="m-evaluate-ratio">'+a.value[e].praisePrecent+'％</p><p class="m-evaluate-votes">'+a.value[e].commentAssessment+"&nbsp;票</p></div></div></li>";$(".m-restaurant-list").html(c),$(".tab-con").hide(),$(".m-mask").hide()}})})}function r(){e($("#order_group li a"))}function t(a){$(".g-restaurant").after("<div class='m-loading'><img src='images/loading.gif' /><div>"),$("#restaurant_list").hide(),setTimeout(function(){$(".m-loading").hide(),$("#restaurant_list").show()},500)}$.ajax({type:"get",url:"http://api.51yuchu.com/search/"+a+"/order/list",dataType:"json",success:function(a){var r="";for(i=0;i<a.value.length;i++)var r=r+"<li><a href='javascript:;' okey='"+a.value[i].key+"'>"+a.value[i].value+"</a></li>";$("#order_restaurant").html(r),e($("#order_restaurant li a"))}}),$.ajax({type:"get",url:"http://api.51yuchu.com/search/region/list?cityId=3",dataType:"json",success:function(a){var r="";for(i=0;i<a.value.length;i++)var r=r+"<li><a href='javascript:;'>"+a.value[i].name+"</a></li>";$("#order_region").html(r),e($("#order_region li a"))}}),$.ajax({type:"get",url:"http://api.51yuchu.com/search/cuisine/list",dataType:"json",success:function(a){var r="";for(i=0;i<a.value.length;i++)var r=r+"<li><a href='javascript:;'>"+a.value[i].name+"</a></li>";$("#order_cuisine").html(r),e($("#order_cuisine li a"))}}),r()}var tabs=function(a,e,r){a.click(function(){var t=a.index(this);a.removeClass("current"),$(this).addClass("current"),e.hide(),e.eq(t).show(),r.show()}),r.click(function(){a.removeClass("current"),e.hide(),r.hide()})},user=store.get("user"),lng=user.lng,lat=user.lat,cityId=user.cityId,Opage=0,Osize=10;$(function(){$(".g-restaurant").dropload({scrollArea:window,loadDownFn:function(a){Opage++;var e="";$.ajax({type:"GET",url:"http://api.51yuchu.com/restaurant/book/list?cityId="+cityId+"&lat="+lat+"&lng="+lng+"&page="+Opage+"&size="+Osize,dataType:"json",success:function(r){if(r.succeed){var t=r.value.list.length;if(t>0)for(var s=0;s<t;s++)e=e+'<li class="m-restaurant"><a href="restaurantdetails.html#'+r.value.list[s].restaurant.id+'" class="m-restaurant-img"><img src="'+r.value.list[s].restaurant.previewUrl+'"alt=""></a><a href="restaurantdetails.html#'+r.value.list[s].restaurant.id+'" class="m-restaurant-text"><h3 class="m-restaurant-tit">'+r.value.list[s].restaurant.name+'</h3><p class="m-restaurant-region">'+r.value.list[s].country.name+'</p><p class="m-restaurant-price">'+r.value.list[s].restaurant.priceStr+'</p></a><div class="m-restaurant-evaluate"><img src="images/bg-pie.png"alt=""><div class="m-evaluate-con"><h4>好评率</h4><p class="m-evaluate-ratio">'+r.value.list[s].praisePrecent+'％</p><p class="m-evaluate-votes">'+r.value.list[s].commentAssessment+"&nbsp;票</p></div></div></li>";else a.lock(),a.noData();setTimeout(function(){$(".m-restaurant-list").append(e),a.resetload()},300)}},error:function(e,r){alert("Ajax error!"),a.resetload()}})}})});